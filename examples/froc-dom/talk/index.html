<html>
  <head>
    <link type="text/css" rel="stylesheet" href="style.css" />
    <script src="talk.js"></script>
  </head>

  <body>
    <div id="slides">

      <div id="title" class="slide center">
        <h1 id="title_title">Better Web GUIs<br/>with<br/>Functional Reactive Programming</h1>

        <p id="title_email">jake@donham.org</p>
      </div>

      <div id="better" class="slide" style="display:none">
        <h2>Better?</h2>

        <p>Not (necessarily)</p>
        <ul>
          <li>faster</li>
          <li>prettier</li>
        </ul>

        <p>But</p>
        <ul>
          <li>less code</li>
          <li>easier to reason about</li>
          <li>fewer bugs</li>
          <li>(more time to make it faster / prettier)</li>
        </ul>
      </div>

      <div id="gui_hard" class="slide" style="display:none">
        <h2>GUIs are hard!</h2>

        <p>Typical GUI impl consists of</p>
        <ul>
          <li>state</li>
          <li>events</li>
          <li>callbacks (a.k.a. observers)</li>
        </ul>

        <p>Problems:</p>
        <ul>
          <li>unmodular: callback soup, control inversion</li>
          <li>state + concurrency = pain (order matters)</li>
        </ul>

        <p>Adobe: 1/3 code and 1/2 bugs due to event handling</p>
      </div>

      <div id="gui_not_hard" class="slide" style="display:none">
        <h2>GUIs should not be hard!</h2>

        <p>Typical GUI represents a <em>thing</em></p>
        <ul>
          <li>internal model of the thing</li>
          <li>input events control model</li>
          <li>render view of thing from model</li>
        </ul>

        <p>Elements of functional programming:</p>
        <ul>
          <li>view is a pure function of model
          <li>model is a pure function of events?
        </ul>
      </div>

      <div id="frp" class="slide" style="display:none">
        <h2>Functional reactive programming</h2>

        <br/>

        <p>Slogan:<p>
        <p style="margin-left: 250px"><b>Dependencies not callbacks!</b></p>

        <br/><br/>

        <p>Think:<p>
        <p style="margin-left: 200px"><b>Spreadsheet cells, without the spreadsheet</b></p>
        <br/>
      </div>

      <div id="ocaml_etc" class="slide" style="display:none">
        <h2>OCaml</h2>
        <ul>
          <li>OCaml: a nice programming language
            <table id="ocaml_etc_syntax" style="border-collapse: collapse">
              <tr>
                <td class="border_bottom">Javascript</td>
                <td class="border_bottom border_left">OCaml</td>
              </tr>
              <tr>
                <td><code>f<span class="tuareg-font-lock-operator">(</span>x<span class="tuareg-font-lock-operator">,</span> y<span class="tuareg-font-lock-operator">)</span></code></td>
                <td class="border_left"><code>f x y</code></td>
              </tr>
              <tr>
                <td><code>foo.bar<span class="tuareg-font-lock-operator">(</span>x<span class="tuareg-font-lock-operator">)</span></code></td>
                <td class="border_left"><code>foo<span class="tuareg-font-lock-operator">#</span>bar x</code></td>
              </tr>
              <tr>
                <td><code><span class="type">Foo</span>.bar<span class="tuareg-font-lock-operator">(</span>x<span class="tuareg-font-lock-operator">)</span></code></td>
                <td class="border_left"><code><span class="type">Foo</span>.bar x</code></td>
              </tr>
              <tr>
                <td><code><span class="keyword">function</span> <span class="tuareg-font-lock-operator">(</span><span class="variable-name">x</span><span class="tuareg-font-lock-operator">)</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">...</span> <span class="tuareg-font-lock-operator">}</span></code></td>
                <td class="border_left"><code><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">...</span></code></td>
              </tr>
              <tr>
                <td><code><span class="tuareg-font-lock-governing">var</span> <span class="variable-name">x</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">...;</span></code></td>
                <td class="border_left"><code><span class="tuareg-font-lock-governing">let</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">...</span> <span class="tuareg-font-lock-governing">in</span></code></td>
              </tr>
              <tr>
                <td><code>x <span class="tuareg-font-lock-operator">?</span> y <span class="tuareg-font-lock-operator">:</span> z</code></td>
                <td class="border_left"><code><span class="keyword">if</span> x <span class="keyword">then</span> y <span class="keyword">else</span> z</code></td>
              </tr>
              <tr>
                <td></td>
                <td class="border_left"><code><span class="tuareg-font-lock-governing">val</span> <span class="variable-name">foo </span><span class="tuareg-font-lock-operator">:</span> <span class="type">int </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> string</span></code></td>
              </tr>
              <tr>
                <td></td>
                <td class="border_left"><code><span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">'</span><span class="type">a t </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">...</span></code></td>
              </tr>
            </table>
          </li>
          <li>ocamljs: compiles OCaml to Javascript</li>
          <li><code>Froc</code>, <code>Dom</code>, <code>Froc_dom</code>: FRP library, access to DOM</li>
        </ul>
      </div>

      <div id="behaviors" class="slide" style="display:none">
        <h2>Behaviors</h2>
        <p>A disembodied spreadsheet cell:</p>
    <pre>
  <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">'</span><span class="type">a behavior</span>
</pre>
        <p><b>Example:</b> <code><input size="1" id="behaviors_input"> <span class="tuareg-font-lock-operator">+</span> 1 <span class="tuareg-font-lock-operator">=</span> <span id="behaviors_output" class="output"></span></code></p>

        <p>Make a <code><span class="type">string behavior</span></code> from an input box:</p>
    <pre>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">input </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Dom</span>.document<span class="tuareg-font-lock-operator">#</span>getElementById <span class="string">"input"</span> <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">value </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc_dom</span>.input_value_b input <span class="tuareg-font-lock-governing">in</span> <span class="tuareg-font-lock-operator">...</span>
</pre>
        <p>Make derived behaviors (updated when dependencies change):</p>
    <pre>
  <span class="tuareg-font-lock-governing">val</span> <span class="variable-name">lift </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">('</span><span class="type">a </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">'</span><span class="type">b</span><span class="tuareg-font-lock-operator">)</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">'</span><span class="type">a behavior </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">'</span><span class="type">b behavior</span>

  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">int_value </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc</span>.lift int_of_string value <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">incr_value </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc</span>.lift <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">+</span> 1<span class="tuareg-font-lock-operator">)</span> int_value <span class="tuareg-font-lock-governing">in</span>
</pre>
      </div>

      <div id="dep_style" class="slide" style="display:none">
        <h2>Dependency style</h2>
      </div>

      <div id="glitch_free" class="slide" style="display:none">
        <h2>Glitch-free update</h2>
        <p><b>Example:</b> <code><span class="tuareg-font-lock-governing">let</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">=</span> <input size="1" id="glitch_free_input"> <span class="tuareg-font-lock-governing">in</span> x <span class="tuareg-font-lock-operator">+</span> 2 <span class="tuareg-font-lock-operator">*</span> x <span class="tuareg-font-lock-operator">=</span> <span id="glitch_free_output" class="output"></span></code></p>

    <pre>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">value </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">...</span> <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc</span>.lift int_of_string value <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">double </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc</span>.lift <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> 2 <span class="tuareg-font-lock-operator">*</span> x<span class="tuareg-font-lock-operator">)</span> x <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">triple </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc</span>.lift2 <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">s d </span><span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">+</span> d<span class="tuareg-font-lock-operator">)</span> x double <span class="tuareg-font-lock-governing">in</span>
</pre>

    <p>Must update in consistent order:</p>
    <img style="margin-left: 250px" src="glitch_free.png">

      </div>

      <div id="dynamic_deps" class="slide" style="display:none">
        <h2>Dynamic dependencies</h2>

        <p><b>Example:</b>
        <code><span class="tuareg-font-lock-governing">let</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">=</span> <input size="1" id="dynamic_deps_input"> <span class="tuareg-font-lock-governing">in</span> <span class="keyword">if</span> x <span class="tuareg-font-lock-operator">=</span> 0 <span class="keyword">then</span> 0 <span class="keyword">else</span> 100 <span class="tuareg-font-lock-operator">/</span> x <span class="tuareg-font-lock-operator">=</span> <span id="dynamic_deps_output" class="output"></code></p>
    <pre>
  <span class="tuareg-font-lock-governing">val</span> <span class="variable-name">return </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">'</span><span class="type">a </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">'</span><span class="type">a behavior</span>
  <span class="tuareg-font-lock-governing">val</span> <span class="variable-name">bind </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">'</span><span class="type">a behavior </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">('</span><span class="type">a </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">'</span><span class="type">b behavior</span><span class="tuareg-font-lock-operator">)</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">'</span><span class="type">b behavior</span>

  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">...</span> <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">b </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc</span>.lift <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">=</span> 0<span class="tuareg-font-lock-operator">)</span> x <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">result </span><span class="tuareg-font-lock-operator">=</span>
    <span class="type">Froc</span>.bind b <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">b </span><span class="tuareg-font-lock-operator">-&gt;</span>
                   <span class="keyword">if</span> b
                   <span class="keyword">then</span> <span class="type">Froc</span>.return 0
                   <span class="keyword">else</span> <span class="type">Froc</span>.lift <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> 100 <span class="tuareg-font-lock-operator">/</span> x<span class="tuareg-font-lock-operator">)</span> x<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-governing">in</span>
</pre>

        <p>Compare:</p>
    <pre>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">x_div </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc</span>.lift <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">/</span> 100<span class="tuareg-font-lock-operator">)</span> x <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">result </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc</span>.bind <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">b </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">if</span> b <span class="keyword">then</span> <span class="type">Froc</span>.return 0 <span class="keyword">else</span> x_div<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-governing">in</span>
</pre>

        <p>Dependencies in scope of <code>bind</code> are removed on updates.</p>
      </div>

      <div id="mvc" class="slide" style="display:none">
        <h2>Compare to MVC / Observer</h2>

        <p>With MVC / Observer pattern:</p>
        <ul>
          <li>programmer manages update order manually</li>
          <li>programmer manages dynamic dependencies manually</li>
          <li>setting up new model + view is heavy</li>
        </ul>
      </div>

      <div id="fritter" class="slide" style="display:none">
        <h2>Example: Fritter</h2>

        <div style="position:relative; width:525px">
          <h3 id="fritter_what">What's happening?</h3>
          <textarea id="fritter_text" cols="40" rows="2"></textarea>
          <div id="fritter_count">140</div>
          <button id="fritter_tweet">Tweet</button>
        </div>
      </div>

      <div id="events" class="slide" style="display:none">
        <h2>Events</h2>

        <p>A disembodied event stream:</p>
    <pre>
  <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">'</span><span class="type">a event</span>
</pre>

        <p><b>Example:</b> <button id="events_button1">Clicks</button> has been clicked <span id="events_output1"></span> times.</p>

        <p>Make a <code><span class="type">Dom.mouseEvent event</span></code> from a button,<br/> and an <code><span class="type">int behavior</span></code> that counts the clicks:</p>
    <pre>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">button </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Dom</span>.document<span class="tuareg-font-lock-operator">#</span>getElementById <span class="string">"button"</span> <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">clicks </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc_dom</span>.clicks button <span class="tuareg-font-lock-governing">in</span> <span class="tuareg-font-lock-operator">...</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">count </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc</span>.count clicks <span class="tuareg-font-lock-governing">in</span>
</pre>

        <p><b>Example:</b> <button id="events_button2">Shift-clicks</button> has been shift-clicked <span id="events_output2"></span> times.</p>
    <pre>
  <span class="tuareg-font-lock-governing">val</span> <span class="variable-name">filter </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">('</span><span class="type">a </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> bool</span><span class="tuareg-font-lock-operator">)</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">'</span><span class="type">a event </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">'</span><span class="type">a event</span>

  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">shift_clicks </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Froc</span>.filter <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">e </span><span class="tuareg-font-lock-operator">-&gt;</span> e<span class="tuareg-font-lock-operator">#</span>_get_shiftKey<span class="tuareg-font-lock-operator">)</span> clicks <span class="tuareg-font-lock-governing">in</span>
</pre>

      </div>

      <div id="output" class="slide" style="display:none">
        <h2>Notifications</h2>

        <p>To do something with an event or behavior:</p>
    <pre>
<span class="type">Froc</span>.notify_b fontSize <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">s </span><span class="tuareg-font-lock-operator">-&gt;</span> e<span class="tuareg-font-lock-operator">#</span>_get_style<span class="tuareg-font-lock-operator">#</span>_set_fontSize s<span class="tuareg-font-lock-operator">);</span>
</pre>
        <p>"Hey, wait, that's just a callback!"</p>

        <p>Yes, but:</p>
        <ul>
          <li>you only need them at the edge of the graph</li>
          <li>dynamic dependencies are handled for you</li>
          <li>alternative: build a value representing whole UI, draw it on changes</li>
          <li>at the end of the day you have to side-effect the screen
        </ul>
      </div>

      <div id="sudoku" class="slide" style="display:none">
        <h2>Example: Sudoku</h2>
        <div id="sudoku_board"></div>
      </div>

      <div id="sudoku_src" class="slide" style="display:none">
        <h2>Example: Sudoku source</h2>

    <pre style="font-size: 18px">
  <span class="tuareg-font-lock-governing">type</span> <span class="type">square </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">{</span>
    <span class="variable-name">i</span> <span class="tuareg-font-lock-operator">:</span> <span class="type">int</span><span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">j</span> <span class="tuareg-font-lock-operator">:</span> <span class="type">int</span><span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">cell</span> <span class="tuareg-font-lock-operator">:</span> <span class="type">int option F.behavior</span><span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">input</span> <span class="tuareg-font-lock-operator">:</span> <span class="type">Dom.input</span><span class="tuareg-font-lock-operator">;</span>
  <span class="tuareg-font-lock-operator">}</span>

  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">squares </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">...</span>

  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">adjacents </span><span class="tuareg-font-lock-operator">{</span> i <span class="tuareg-font-lock-operator">=</span> i<span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> j <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">=</span>
    <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">adjacent </span><span class="tuareg-font-lock-operator">{</span> i <span class="tuareg-font-lock-operator">=</span> i<span class="tuareg-font-lock-operator">';</span> j <span class="tuareg-font-lock-operator">=</span> j<span class="tuareg-font-lock-operator">'</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">=</span>
      <span class="tuareg-font-lock-operator">(not</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">'</span> <span class="tuareg-font-lock-operator">=</span> i <span class="tuareg-font-lock-operator">&amp;&amp;</span> j<span class="tuareg-font-lock-operator">'</span> <span class="tuareg-font-lock-operator">=</span> j<span class="tuareg-font-lock-operator">))</span> <span class="tuareg-font-lock-operator">&amp;&amp;</span>
        <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">'</span> <span class="tuareg-font-lock-operator">=</span> i <span class="tuareg-font-lock-operator">||</span> j<span class="tuareg-font-lock-operator">'</span> <span class="tuareg-font-lock-operator">=</span> j <span class="tuareg-font-lock-operator">||</span>
            <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">'</span> <span class="tuareg-font-lock-operator">/</span> 3 <span class="tuareg-font-lock-operator">=</span> i <span class="tuareg-font-lock-operator">/</span> 3 <span class="tuareg-font-lock-operator">&amp;&amp;</span> j<span class="tuareg-font-lock-operator">'</span> <span class="tuareg-font-lock-operator">/</span> 3 <span class="tuareg-font-lock-operator">=</span> j <span class="tuareg-font-lock-operator">/</span> 3<span class="tuareg-font-lock-operator">))</span> <span class="tuareg-font-lock-governing">in</span>
    <span class="type">List</span>.map <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">sq </span><span class="tuareg-font-lock-operator">-&gt;</span> sq.cell<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">(</span><span class="type">List</span>.filter adjacent squares<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-governing">in</span>

  <span class="type">List</span>.iter
    <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">sq </span><span class="tuareg-font-lock-operator">-&gt;</span>
       <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">backgroundColor </span><span class="tuareg-font-lock-operator">=</span>
         <span class="type">F</span>.bindN <span class="tuareg-font-lock-operator">(</span>adjacents sq<span class="tuareg-font-lock-operator">)</span>
           <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">adjs </span><span class="tuareg-font-lock-operator">-&gt;</span>
              <span class="type">F</span>.lift
                <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">v </span><span class="tuareg-font-lock-operator">-&gt;</span>
                   <span class="keyword">if</span> v <span class="tuareg-font-lock-operator">&lt;&gt;</span> None <span class="tuareg-font-lock-operator">&amp;&amp;</span> <span class="type">List</span>.mem v adjs
                   <span class="keyword">then</span> <span class="string">"#ff0000"</span>
                   <span class="keyword">else</span> <span class="string">"#ffffff"</span><span class="tuareg-font-lock-operator">)</span>
                sq.cell<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-governing">in</span>
       <span class="type">Fd</span>.attach_backgroundColor_b sq.input backgroundColor<span class="tuareg-font-lock-operator">)</span>
    squares<span class="tuareg-font-lock-operator">;</span>
</pre>
      </div>

      <div id="bounce" class="slide" style="display:none">
        <h2>Example: Bounce</h2>

        <canvas id="bounce_canvas" width="500" height="500" style="border-style:solid"></canvas>
      </div>

      <div id="bounce_src" class="slide" style="display:none">
        <h2>Example: Bounce source</h2>

    <pre style="font-size: 16px">
<span class="tuareg-font-lock-governing">let</span> <span class="variable-name">ball_point </span><span class="tuareg-font-lock-operator">=</span>
  <span class="type">F</span>.fix_b <span class="tuareg-font-lock-governing">begin</span> <span class="keyword">fun</span> <span class="variable-name">bp </span><span class="tuareg-font-lock-operator">-&gt;</span>
    <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">x_out_of_bounds </span><span class="tuareg-font-lock-operator">=</span>
      <span class="type">F</span>.map
        <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="tuareg-font-lock-operator">()</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">-&gt;</span> `X_bounds<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">(</span><span class="type">F</span>.when_true
           <span class="tuareg-font-lock-operator">(</span><span class="type">F</span>.lift <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="tuareg-font-lock-operator">(</span><span class="variable-name">x</span><span class="tuareg-font-lock-operator">,</span><span class="variable-name"> _</span><span class="tuareg-font-lock-operator">)</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">&lt;=</span> min <span class="tuareg-font-lock-operator">||</span> x <span class="tuareg-font-lock-operator">&gt;=</span> max<span class="tuareg-font-lock-operator">)</span> bp<span class="tuareg-font-lock-operator">))</span> <span class="tuareg-font-lock-governing">in</span>
    <span class="tuareg-font-lock-operator">...</span>
    <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">v </span><span class="tuareg-font-lock-operator">=</span>
      <span class="type">F</span>.fix_b <span class="tuareg-font-lock-governing">begin</span> <span class="keyword">fun</span> <span class="variable-name">v </span><span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="type">F</span>.hold
          init_v
          <span class="tuareg-font-lock-operator">(</span><span class="type">F</span>.map
             <span class="tuareg-font-lock-governing">begin</span> <span class="keyword">fun</span> <span class="variable-name">e </span><span class="tuareg-font-lock-operator">-&gt;</span>
               <span class="tuareg-font-lock-governing">let</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">(</span><span class="variable-name">vx</span><span class="tuareg-font-lock-operator">,</span><span class="variable-name"> vy</span><span class="tuareg-font-lock-operator">)</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">=</span> <span class="type">F</span>.sample v <span class="tuareg-font-lock-governing">in</span>
               <span class="tuareg-font-lock-governing">let</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">(</span><span class="variable-name">x</span><span class="tuareg-font-lock-operator">,</span><span class="variable-name"> y</span><span class="tuareg-font-lock-operator">)</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">=</span> <span class="type">F</span>.sample bp <span class="tuareg-font-lock-governing">in</span>
               <span class="keyword">match</span> e <span class="keyword">with</span>
                 <span class="tuareg-font-lock-operator">|</span> `X_bounds <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(-.</span>vx<span class="tuareg-font-lock-operator">,</span> vy<span class="tuareg-font-lock-operator">)</span>
                 <span class="tuareg-font-lock-operator">|</span> `Y_bounds <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>vx<span class="tuareg-font-lock-operator">,</span> <span class="tuareg-font-lock-operator">-.</span>vy<span class="tuareg-font-lock-operator">)</span>
                 <span class="tuareg-font-lock-operator">|</span> `Xy_bounds <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(-.</span>vx<span class="tuareg-font-lock-operator">,</span> <span class="tuareg-font-lock-operator">-.</span>vy<span class="tuareg-font-lock-operator">)</span>
                 <span class="tuareg-font-lock-operator">|</span> `Paddle <span class="tuareg-font-lock-operator">-&gt;</span>
                     <span class="tuareg-font-lock-governing">let</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">(</span><span class="variable-name">px</span><span class="tuareg-font-lock-operator">,</span><span class="variable-name"> py</span><span class="tuareg-font-lock-operator">)</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">=</span> <span class="type">F</span>.sample paddle_point <span class="tuareg-font-lock-governing">in</span>
                     <span class="comment">(* bounce v off the tangent to the paddle *)</span>
                     <span class="tuareg-font-lock-operator">...</span>
             <span class="tuareg-font-lock-governing">end</span>
             <span class="tuareg-font-lock-operator">(</span><span class="type">F</span>.merge <span class="tuareg-font-lock-operator">[</span> xy_out_of_bounds<span class="tuareg-font-lock-operator">;</span> x_out_of_bounds<span class="tuareg-font-lock-operator">;</span> y_out_of_bounds<span class="tuareg-font-lock-operator">;</span> hit_paddle <span class="tuareg-font-lock-operator">]))</span>
      <span class="tuareg-font-lock-governing">end</span> <span class="tuareg-font-lock-governing">in</span>
  
    <span class="type">F</span>.hold init_p
      <span class="tuareg-font-lock-operator">(</span><span class="type">F</span>.collect
         <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="tuareg-font-lock-operator">(</span><span class="variable-name">x</span><span class="tuareg-font-lock-operator">,</span><span class="variable-name"> y</span><span class="tuareg-font-lock-operator">)</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">()</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">vx</span><span class="tuareg-font-lock-operator">,</span><span class="variable-name"> vy </span><span class="tuareg-font-lock-operator">=</span> <span class="type">F</span>.sample v <span class="tuareg-font-lock-governing">in</span> <span class="tuareg-font-lock-operator">(</span>x <span class="tuareg-font-lock-operator">+.</span> vx<span class="tuareg-font-lock-operator">,</span> y <span class="tuareg-font-lock-operator">+.</span> vy<span class="tuareg-font-lock-operator">))</span>
         init_p
         <span class="tuareg-font-lock-operator">(</span><span class="type">Fd</span>.ticks 20.<span class="tuareg-font-lock-operator">))</span>
</pre>
      </div>

      <div id="implementation" class="slide" style="display:none">
        <h2>Implementation</h2>

        <ul>
          <li>bunch of callbacks :)</li>
          <li>nodes in dep graph assigned abstract timestamp at eval</li>
          <li>notifications sent in timestamp order w/ priority queue</li>
          <li>dependent functions delimit timestamp range;
          <li>timestamp ranges cleaned up (to unregister dyn deps etc.)
        </ul>
        <p>more at</p>
        <p><a href="http://ambassadortothecomputers.blogspot.com/2010/05/how-froc-works.html">ambassadortothecomputers.blogspot.com/2010/05/how-froc-works.html</a></p>
      </div>

      <div id="why_ocaml" class="slide" style="display:none">
        <h2>Why OCaml for FRP?</h2>

        <p>OCaml is a sweet-spot for FRP:</p>
        <ul>
          <li>value-oriented mindset</li>
          <li>higher-order functions</li>
          <li>static typing...</li>
          <li>...but types usually inferred</li>
          <li>imperative implementation possible</li>
        </ul>

        <p>But FRP impls in many languages:</p>
        <ul>
          <li>Scheme (<a href="http://www.cs.brown.edu/~greg/">FrTime</a>), Javascript (<a href="http://www.flapjax-lang.org/">Flapjax</a>)</li>
          <li>Haskell (<a href="http://conal.net/fran/">Fran</a> and many descendents)</li>
          <li>Scala (<a href="http://lamp.epfl.ch/~imaier/">Scala.React</a>), even Lua (<a href="http://www.lua.inf.puc-rio.br/luagravity/">LuaGravity</a>)</li>
        </ul>
      </div>

      <div id="reactive" class="slide" style="display:none">
        <h2>FRP for reactive programming?</h2>

        <p>Most programming is reactive programming (?)</p>
        <ul>
          <li>program is in some state</li>
          <li>s**t happens (timer goes off, input arrives)</li>
          <li>program reacts, changing state (and usually responding with output)</li>
        </ul>

        <p>e.g.</p>
        <ul>
          <li>industrial control systems</li>
          <li>network stacks</li>
          <li>event-driven servers</li>
        </ul>

        <p>is there a role for FRP outside of GUIs?</p>
      </div>

      <div id="thanks" class="slide" style="display:none">
        <h2>Thanks!</h2>
        <p>Takeaways:</p>
        <ul>
          <li>functional programming is important</li>
          <li>immutable values are important</li>
          <li>types are important</li>
        </ul>

        <p>Code:</p>
        <ul>
          <li><a href="http://github.com/jaked/ocamljs">http://github.com/jaked/ocamljs</a></li>
          <li><a href="http://github.com/jaked/froc">http://github.com/jaked/froc</a></li>
        </ul>
      </div>

    </div>

    <div id="nav" style="display:none">
      <span id="nav_page_num">0</span> / <span id="nav_page_total"></span>
    </div>
  </body>
</html>
